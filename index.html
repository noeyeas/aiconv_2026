<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#EAEEFC">
    <title>ê´‘ìš´ëŒ€í•™êµ ì¸ê³µì§€ëŠ¥ìœµí•©ëŒ€í•™ ì˜¤í”ˆì¹´í†¡ë°© ì¸ì¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&family=Black+Han+Sans&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        peri: {
                            50: '#F5F7FC',
                            100: '#EAEEFC',
                            200: '#D5DEFC',
                            300: '#B8C8F7',
                            400: '#9BABEB',
                            500: '#8B9AD4',
                            600: '#7082BE',
                            700: '#5A6BA3',
                            800: '#4A5882',
                            900: '#3D4A6B'
                        }
                    },
                    fontFamily: {
                        'gothic': ['Nanum Gothic', 'sans-serif'],
                        'title': ['Black Han Sans', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        /* ê¸°ë³¸ ë¦¬ì…‹ ë° ë°•ìŠ¤ ì‚¬ì´ì§• */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Nanum Gothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }
        
        /* Tailwind ë°±ì—… ìŠ¤íƒ€ì¼ */
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .flex-shrink-0 { flex-shrink: 0; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .font-bold { font-weight: 700; }
        .font-medium { font-weight: 500; }
        .underline { text-decoration: underline; }
        .w-full { width: 100%; }
        .min-h-screen { min-height: 100vh; }
        .max-w-lg { max-width: 32rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-6 { margin-top: 1.5rem; }
        .mt-8 { margin-top: 2rem; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .p-8 { padding: 2rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .py-12 { padding-top: 3rem; padding-bottom: 3rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .text-sm { font-size: 0.875rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-3xl { font-size: 1.875rem; }
        .text-4xl { font-size: 2.25rem; }
        .text-white { color: white; }
        .rounded-full { border-radius: 9999px; }
        .rounded-xl { border-radius: 0.75rem; }
        .rounded-2xl { border-radius: 1rem; }
        .rounded-3xl { border-radius: 1.5rem; }
        .max-h-48 { max-height: 12rem; }
        .w-5 { width: 1.25rem; }
        .h-5 { height: 1.25rem; }
        .w-7 { width: 1.75rem; }
        .h-7 { height: 1.75rem; }
        .w-8 { width: 2rem; }
        .h-8 { height: 2rem; }
        .w-12 { width: 3rem; }
        .h-12 { height: 3rem; }
        .w-14 { width: 3.5rem; }
        .h-14 { height: 3.5rem; }
        .w-16 { width: 4rem; }
        .h-16 { height: 4rem; }
        
        /* ì»¤ìŠ¤í…€ ìƒ‰ìƒ */
        .text-peri-500 { color: #8B9AD4; }
        .text-peri-600 { color: #7082BE; }
        .text-peri-700 { color: #5A6BA3; }
        .text-peri-800 { color: #4A5882; }
        .bg-peri-200 { background-color: #D5DEFC; }
        .text-green-500 { color: #22C55E; }
        .text-green-600 { color: #16A34A; }
        .text-red-500 { color: #EF4444; }
        .text-gray-900 { color: #111827; }
        .bg-yellow-400 { background-color: #FACC15; }
        .bg-yellow-300 { background-color: #FDE047; }
        
        /* ë°°ê²½ */
        .bg-pattern {
            background: linear-gradient(135deg, #F5F7FC 0%, #EAEEFC 50%, #E0E7FA 100%);
            background-attachment: fixed;
        }
        
        .bg-pattern::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(184, 200, 247, 0.4) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(155, 171, 235, 0.3) 0%, transparent 35%),
                radial-gradient(circle at 50% 50%, rgba(139, 154, 212, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        .bg-pattern::after {
            content: '';
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120vmin;
            height: 120vmin;
            background-image: url('logo.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            opacity: 0.07;
            pointer-events: none;
            z-index: 0;
        }
        
        /* ì¹´ë“œ */
        .card-glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(184, 200, 247, 0.5);
            box-shadow: 0 8px 32px rgba(139, 154, 212, 0.15);
        }
        
        /* ì—…ë¡œë“œ ì˜ì—­ */
        .upload-zone {
            border: 2px dashed rgba(139, 154, 212, 0.5);
            background: rgba(245, 247, 252, 0.5);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .upload-zone:hover, .upload-zone.dragover {
            border-color: #8B9AD4;
            background: rgba(184, 200, 247, 0.2);
        }
        
        /* ì¸ì¦ ë²„íŠ¼ */
        .btn-verify {
            background: linear-gradient(135deg, #9BABEB 0%, #8B9AD4 100%);
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-verify:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(139, 154, 212, 0.4);
        }
        
        .btn-verify:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        .slide-up {
            animation: slideUp 0.6s ease forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .loading-spinner {
            border: 3px solid rgba(184, 200, 247, 0.3);
            border-top-color: #8B9AD4;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ê²°ê³¼ ì¹´ë“œ */
        .success-card {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        
        .error-card {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.05) 100%);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .code-box {
            background: linear-gradient(135deg, #F5F7FC 0%, #EAEEFC 100%);
            border: 1px solid rgba(139, 154, 212, 0.3);
            font-family: 'Courier New', monospace;
            letter-spacing: 0.1em;
        }
        
        .bg-peri-100-50 {
            background: rgba(234, 238, 252, 0.5);
        }
        
        .bg-green-500-20 {
            background: rgba(34, 197, 94, 0.2);
        }
        
        .bg-red-500-20 {
            background: rgba(239, 68, 68, 0.2);
        }
        
        .content-wrapper {
            position: relative;
            z-index: 1;
        }
        
        /* í°íŠ¸ */
        .font-title {
            font-family: 'Black Han Sans', 'Nanum Gothic', sans-serif;
        }
        
        /* ëª¨ë°”ì¼ safe area ì§€ì› */
        .safe-area {
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        /* ëª¨ë°”ì¼ í„°ì¹˜ ìµœì í™” */
        .touch-target {
            min-height: 48px;
            touch-action: manipulation;
        }
        
        /* ëª¨ë°”ì¼ì—ì„œ íƒ­ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        /* ë²„íŠ¼ active ìƒíƒœ */
        .btn-verify:active:not(:disabled) {
            transform: scale(0.98);
        }
        
        .upload-zone:active {
            transform: scale(0.99);
        }
        
        /* ë§í¬/ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        a, button {
            text-decoration: none;
            cursor: pointer;
        }
        
        /* ì¹´ì¹´ì˜¤ ë²„íŠ¼ */
        .kakao-btn {
            display: block;
            width: 100%;
            padding: 0.75rem 1rem;
            background-color: #FACC15;
            border-radius: 0.75rem;
            color: #111827;
            font-weight: 700;
            text-align: center;
            transition: background-color 0.2s;
        }
        
        .kakao-btn:hover {
            background-color: #FDE047;
        }
        
        /* ë³µì‚¬ ë²„íŠ¼ */
        .copy-btn {
            background: rgba(139, 154, 212, 0.15);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .copy-btn:hover {
            background: rgba(139, 154, 212, 0.3);
        }
        
        .copy-btn:active {
            transform: scale(0.95);
        }
        
        .w-6 { width: 1.5rem; }
        .h-6 { height: 1.5rem; }
        
        /* ì´ë¯¸ì§€ */
        img {
            max-width: 100%;
            height: auto;
        }
        
        /* SVG ì•„ì´ì½˜ */
        svg {
            display: block;
        }
    </style>
</head>
<body class="bg-pattern min-h-screen safe-area">
    <div class="content-wrapper min-h-screen flex flex-col items-center justify-center px-4 py-12">
        <!-- Header -->
        <div class="text-center mb-8 slide-up">
            <h1 class="font-title text-4xl md:text-5xl text-peri-800 mb-2" ondblclick="showAdminPrompt()">
                ì¸ê³µì§€ëŠ¥ìœµí•©ëŒ€í•™
            </h1>
            <p class="text-peri-500 text-sm mb-3">ì œ3ëŒ€ í•™ìƒíšŒ í•˜ì„±</p>
            <p class="text-peri-600 text-lg">ì˜¤í”ˆì¹´í†¡ë°© ì…ì¥ ì¸ì¦</p>
        </div>
        
        <!-- Admin Panel (ìˆ¨ê¹€) -->
        <div id="adminPanel" class="hidden w-full max-w-lg card-glass rounded-3xl p-6 mb-6 slide-up">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-peri-800 text-lg font-bold">ğŸ”§ ê´€ë¦¬ì ëª¨ë“œ</h2>
                <button onclick="closeAdminPanel()" class="text-peri-500 text-sm">ë‹«ê¸° âœ•</button>
            </div>
            <div class="bg-peri-100/50 rounded-xl p-4 max-h-64 overflow-y-auto">
                <p class="text-peri-600 text-sm mb-2">ì¶”ì¶œëœ ì´ë¦„ ëª©ë¡:</p>
                <div id="adminNameList" class="text-peri-800 text-sm font-mono">
                    <p class="text-peri-500">ì•„ì§ ì¶”ì¶œëœ ì´ë¦„ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
            <p class="text-peri-500 text-xs mt-3">ì´ <span id="adminNameCount">0</span>ëª…</p>
        </div>
        
        <!-- Main Card -->
        <div class="w-full max-w-lg card-glass rounded-3xl p-8 slide-up" style="animation-delay: 0.1s;">
            <!-- Upload Section -->
            <div id="uploadSection">
                <!-- 1. ë„ì„œê´€ QR ì´ë¯¸ì§€ -->
                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="w-6 h-6 rounded-full bg-peri-200 flex items-center justify-center text-peri-700 text-sm font-bold">1</span>
                        <h2 class="text-peri-800 text-lg font-bold">ë„ì„œê´€ QR ì´ë¯¸ì§€</h2>
                    </div>
                    <p class="text-peri-600 text-sm ml-8">ëª¨ë°”ì¼ í•™ìƒì¦ì˜ ë„ì„œê´€ QR ìº¡ì²˜ ì´ë¯¸ì§€</p>
                </div>
                
                <!-- QR ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
                <div id="qrPreviewZone" class="hidden upload-zone rounded-2xl p-4 text-center mb-4">
                    <img id="qrPreviewImg" class="max-h-36 mx-auto rounded-xl mb-2" alt="QR ë¯¸ë¦¬ë³´ê¸°">
                    <p id="qrFileName" class="text-peri-600 text-sm mb-2"></p>
                    <button type="button" onclick="resetQrPreview()" class="text-peri-500 text-sm underline touch-target">
                        ë‹¤ë¥¸ ì´ë¯¸ì§€ ì„ íƒ
                    </button>
                </div>
                
                <!-- QR ì—…ë¡œë“œ ë²„íŠ¼ -->
                <div id="qrUploadBtn" class="mb-6">
                    <input type="file" id="qrFileInput" accept="image/*" class="hidden" onchange="handleQrFileSelect(event)">
                    <button 
                        type="button"
                        onclick="document.getElementById('qrFileInput').click()"
                        class="upload-zone rounded-2xl p-4 w-full flex items-center justify-center gap-3 touch-target"
                    >
                        <div class="w-12 h-12 rounded-xl bg-peri-200 flex items-center justify-center flex-shrink-0">
                            <svg class="w-6 h-6 text-peri-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path>
                            </svg>
                        </div>
                        <div class="text-left">
                            <p class="text-peri-700 font-medium">QR ì´ë¯¸ì§€ ì„ íƒ</p>
                            <p class="text-peri-500 text-sm">ë„ì„œê´€ QR ìº¡ì²˜ ì´ë¯¸ì§€</p>
                        </div>
                    </button>
                </div>
                
                <!-- 2. ì£¼ë¯¼ë“±ë¡ì¦ ì´ë¯¸ì§€ -->
                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="w-6 h-6 rounded-full bg-peri-200 flex items-center justify-center text-peri-700 text-sm font-bold">2</span>
                        <h2 class="text-peri-800 text-lg font-bold">ì£¼ë¯¼ë“±ë¡ì¦ ì‚¬ì§„</h2>
                    </div>
                    <p class="text-peri-600 text-sm ml-8">ë³¸ì¸ í™•ì¸ì„ ìœ„í•œ ì£¼ë¯¼ë“±ë¡ì¦ ì‚¬ì§„</p>
                </div>
                
                <!-- ì£¼ë¯¼ë“±ë¡ì¦ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
                <div id="idPreviewZone" class="hidden upload-zone rounded-2xl p-4 text-center mb-4">
                    <img id="idPreviewImg" class="max-h-36 mx-auto rounded-xl mb-2" alt="ì£¼ë¯¼ë“±ë¡ì¦ ë¯¸ë¦¬ë³´ê¸°">
                    <p id="idFileName" class="text-peri-600 text-sm mb-2"></p>
                    <button type="button" onclick="resetIdPreview()" class="text-peri-500 text-sm underline touch-target">
                        ë‹¤ë¥¸ ì´ë¯¸ì§€ ì„ íƒ
                    </button>
                </div>
                
                <!-- ì£¼ë¯¼ë“±ë¡ì¦ ì—…ë¡œë“œ ë²„íŠ¼ -->
                <div id="idUploadBtn" class="mb-4">
                    <input type="file" id="idFileInput" accept="image/*" class="hidden" onchange="handleIdFileSelect(event)">
                    <button 
                        type="button"
                        onclick="document.getElementById('idFileInput').click()"
                        class="upload-zone rounded-2xl p-4 w-full flex items-center justify-center gap-3 touch-target"
                    >
                        <div class="w-12 h-12 rounded-xl bg-peri-200 flex items-center justify-center flex-shrink-0">
                            <svg class="w-6 h-6 text-peri-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"></path>
                            </svg>
                        </div>
                        <div class="text-left">
                            <p class="text-peri-700 font-medium">ì£¼ë¯¼ë“±ë¡ì¦ ì„ íƒ</p>
                            <p class="text-peri-500 text-sm">ë³¸ì¸ í™•ì¸ìš© ì‹ ë¶„ì¦ ì‚¬ì§„</p>
                        </div>
                    </button>
                </div>
                
                
                <button 
                    id="verifyBtn" 
                    class="btn-verify w-full py-4 rounded-xl text-white font-bold text-lg disabled:opacity-50"
                    onclick="verifyImage()"
                    disabled
                >
                    ì¸ì¦í•˜ê¸°
                </button>
            </div>
            
            <!-- Loading Section -->
            <div id="loadingSection" class="hidden text-center py-8">
                <div class="loading-spinner w-16 h-16 rounded-full mx-auto mb-6"></div>
                <p id="loadingStatus" class="text-peri-700 text-xl font-bold">í™•ì¸ì¤‘... 0%</p>
            </div>
            
            <!-- Result Section -->
            <div id="resultSection" class="hidden">
                <!-- Success -->
                <div id="successResult" class="hidden">
                    <div class="success-card rounded-2xl p-6 mb-6 text-center">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-green-500-20 flex items-center justify-center">
                            <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>
                        <h3 class="text-green-600 text-xl font-bold mb-2">ì¸ì¦ ì„±ê³µ!</h3>
                        <p id="detectedDept" class="text-peri-600 text-sm"></p>
                    </div>
                    
                    <div class="bg-peri-100-50 rounded-2xl p-6 mb-4">
                        <p class="text-peri-600 text-sm mb-3">ì˜¤í”ˆì¹´í†¡ë°© ë§í¬</p>
                        <a 
                            href="https://open.kakao.com/o/g5oHeOai" 
                            target="_blank"
                            class="kakao-btn"
                        >
                            ğŸ’¬ ì˜¤í”ˆì¹´í†¡ë°© ì…ì¥í•˜ê¸°
                        </a>
                    </div>
                    
                    <div class="bg-peri-100-50 rounded-2xl p-6">
                        <p class="text-peri-600 text-sm mb-3">ì°¸ì—¬ ì½”ë“œ</p>
                        <div class="code-box rounded-xl py-4 flex items-center justify-center gap-4">
                            <span class="text-3xl text-peri-700 font-bold">aiconv26</span>
                            <button 
                                onclick="copyCode()"
                                class="copy-btn p-2 rounded-lg"
                                title="ë³µì‚¬í•˜ê¸°"
                            >
                                <svg id="copyIcon" class="w-6 h-6 text-peri-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <svg id="checkIcon" class="w-6 h-6 text-green-500 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </button>
                        </div>
                        <p id="copyMsg" class="text-green-500 text-sm text-center mt-2 hidden">ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
                    </div>
                </div>
                
                <!-- Error -->
                <div id="errorResult" class="hidden">
                    <div class="error-card rounded-2xl p-6 text-center">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-red-500-20 flex items-center justify-center">
                            <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </div>
                        <h3 class="text-red-500 text-xl font-bold mb-2">ì¸ì¦ ì‹¤íŒ¨</h3>
                        <p id="errorMessage" class="text-peri-600 text-sm mb-6"></p>
                        <button 
                            class="px-6 py-3 bg-peri-200 hover:bg-peri-300 rounded-xl text-peri-700 font-medium transition-colors"
                            onclick="resetForm()"
                        >
                            ë‹¤ì‹œ ì‹œë„í•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Privacy Notice -->
            <div class="mt-6 flex items-start gap-3 p-4 bg-peri-100/50 rounded-xl">
                <svg class="w-5 h-5 text-peri-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                </svg>
                <p class="text-peri-600 text-sm">
                    <span class="text-peri-700 font-medium">ê°œì¸ì •ë³´ ë³´í˜¸</span><br>
                    ì—…ë¡œë“œëœ ì´ë¯¸ì§€ëŠ” ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•Šìœ¼ë©°, ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.
                </p>
            </div>
        </div>
        
        <!-- Footer -->
        <p class="text-peri-500 text-sm mt-8">
            Â© 2026 ê´‘ìš´ëŒ€í•™êµ ì¸ê³µì§€ëŠ¥ìœµí•©ëŒ€í•™
        </p>
    </div>

    <script>
        let qrFile = null;
        let idFile = null;
        const validDepartments = ['ì¸ê³µì§€ëŠ¥ìœµí•©ëŒ€í•™', 'ì»´í“¨í„°ì •ë³´ê³µí•™ë¶€', 'ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€', 'ì •ë³´ìœµí•©í•™ë¶€'];
        
        // ê´€ë¦¬ì ëª¨ë“œìš© - ì¶”ì¶œëœ ì´ë¦„ ì €ì¥
        let extractedNames = JSON.parse(localStorage.getItem('extractedNames') || '[]');
        
        // ê´€ë¦¬ì ëª¨ë“œ ì—´ê¸°
        function showAdminPrompt() {
            const password = prompt('ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (password === '041104') {
                document.getElementById('adminPanel').classList.remove('hidden');
                updateAdminNameList();
            }
        }
        
        // ê´€ë¦¬ì íŒ¨ë„ ë‹«ê¸°
        function closeAdminPanel() {
            document.getElementById('adminPanel').classList.add('hidden');
        }
        
        // ì´ë¦„ ì¶”ê°€
        function addExtractedName(name, studentId, dept) {
            const timestamp = new Date().toLocaleString('ko-KR');
            extractedNames.push({ name, studentId, dept, timestamp });
            localStorage.setItem('extractedNames', JSON.stringify(extractedNames));
            updateAdminNameList();
        }
        
        // ê´€ë¦¬ì ì´ë¦„ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateAdminNameList() {
            const listEl = document.getElementById('adminNameList');
            const countEl = document.getElementById('adminNameCount');
            
            if (extractedNames.length === 0) {
                listEl.innerHTML = '<p class="text-peri-500">ì•„ì§ ì¶”ì¶œëœ ì´ë¦„ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                countEl.textContent = '0';
            } else {
                listEl.innerHTML = extractedNames.map((item, idx) => 
                    `<div class="py-1 border-b border-peri-200 last:border-0">
                        <span class="text-peri-400">${idx + 1}.</span> 
                        <strong>${item.name || 'ì´ë¦„ì—†ìŒ'}</strong> 
                        <span class="text-peri-500">(${item.studentId || '-'})</span>
                        <br><span class="text-xs text-peri-400">${item.timestamp}</span>
                    </div>`
                ).join('');
                countEl.textContent = extractedNames.length;
            }
        }
        
        // QR ì´ë¯¸ì§€ ì„ íƒ
        function handleQrFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                qrFile = file;
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('qrUploadBtn').classList.add('hidden');
                    document.getElementById('qrPreviewZone').classList.remove('hidden');
                    document.getElementById('qrPreviewImg').src = e.target.result;
                    document.getElementById('qrFileName').textContent = file.name;
                    updateVerifyButton();
                };
                reader.readAsDataURL(file);
            }
        }
        
        // ì£¼ë¯¼ë“±ë¡ì¦ ì´ë¯¸ì§€ ì„ íƒ
        function handleIdFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                idFile = file;
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('idUploadBtn').classList.add('hidden');
                    document.getElementById('idPreviewZone').classList.remove('hidden');
                    document.getElementById('idPreviewImg').src = e.target.result;
                    document.getElementById('idFileName').textContent = file.name;
                    updateVerifyButton();
                };
                reader.readAsDataURL(file);
            }
        }
        
        function resetQrPreview() {
            qrFile = null;
            document.getElementById('qrFileInput').value = '';
            document.getElementById('qrPreviewZone').classList.add('hidden');
            document.getElementById('qrUploadBtn').classList.remove('hidden');
            updateVerifyButton();
        }
        
        function resetIdPreview() {
            idFile = null;
            document.getElementById('idFileInput').value = '';
            document.getElementById('idPreviewZone').classList.add('hidden');
            document.getElementById('idUploadBtn').classList.remove('hidden');
            updateVerifyButton();
        }
        
        function updateVerifyButton() {
            document.getElementById('verifyBtn').disabled = !(qrFile && idFile);
        }
        
        async function verifyImage() {
            if (!qrFile || !idFile) return;
            
            // Show loading
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('loadingSection').classList.remove('hidden');
            document.getElementById('loadingSection').classList.add('fade-in');
            
            try {
                const loadingStatus = document.getElementById('loadingStatus');
                
                // Step 1: QR ì½”ë“œ ë””ì½”ë”©
                loadingStatus.textContent = 'í™•ì¸ì¤‘... 0%';
                const qrData = await decodeQRCode(qrFile);
                
                if (!qrData) {
                    showError('QR ì½”ë“œë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„ì„œê´€ QR ì´ë¯¸ì§€ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                console.log('QR ì½”ë“œ ë°ì´í„°:', qrData);
                
                // Step 2: í•™ë²ˆ í™•ì¸
                // í•™ë²ˆ êµ¬ì¡°: ë…„ë„(4ìë¦¬) + ì‹ë³„ë²ˆí˜¸(3~4ìë¦¬) + ê°œì¸ë²ˆí˜¸
                // ì‹ ì…ìƒ(4ìë¦¬): 4020-ì»´í“¨í„°ì •ë³´ê³µí•™ë¶€, 4030-ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€, 4040-ì •ë³´ìœµí•©í•™ë¶€, 4050-ë¡œë´‡í•™ë¶€
                // ê³ í•™ë²ˆ(3ìë¦¬): 202-ì»´í“¨í„°ì •ë³´ê³µí•™ë¶€, 203-ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€, 204-ì •ë³´ìœµí•©í•™ë¶€, 205-ë¡œë´‡í•™ë¶€
                const studentIdPattern = /\d{4}(4020|4030|4040|4050|202|203|204|205)\d+/;
                const foundStudentId = qrData.match(studentIdPattern);
                
                let foundDepartment = null;
                for (const dept of validDepartments) {
                    if (qrData.includes(dept)) {
                        foundDepartment = dept;
                        break;
                    }
                }
                
                if (!foundStudentId && !foundDepartment) {
                    showError('QR ì½”ë“œì—ì„œ ì¸ê³µì§€ëŠ¥ìœµí•©ëŒ€í•™ ì†Œì† ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                // Step 3: QR ì´ë¯¸ì§€ì—ì„œ ì´ë¦„ ì¶”ì¶œ (OCR)
                loadingStatus.textContent = 'í™•ì¸ì¤‘... 30%';
                const qrOcrResult = await extractTextFromImage(qrFile);
                
                const qrName = extractNameFromQR(qrOcrResult);
                console.log('QRì—ì„œ ì¶”ì¶œí•œ ì´ë¦„:', qrName);
                
                if (!qrName) {
                    showError('QR ì´ë¯¸ì§€ì—ì„œ ì´ë¦„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ë¦„ì´ ë³´ì´ëŠ” ìº¡ì²˜ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // Step 4: ì£¼ë¯¼ë“±ë¡ì¦ ì‚¬ì§„ í™•ì¸
                loadingStatus.textContent = 'í™•ì¸ì¤‘... 90%';
                console.log('ì£¼ë¯¼ë“±ë¡ì¦ ì´ë¯¸ì§€ ì—…ë¡œë“œ í™•ì¸:', idFile.name);
                
                // Show results - ì£¼ë¯¼ë“±ë¡ì¦ ì´ë¯¸ì§€ê°€ ì—…ë¡œë“œë˜ë©´ ì¸ì¦ ì™„ë£Œ
                document.getElementById('loadingSection').classList.add('hidden');
                document.getElementById('resultSection').classList.remove('hidden');
                document.getElementById('resultSection').classList.add('fade-in');
                
                document.getElementById('successResult').classList.remove('hidden');
                let verificationMessage = foundStudentId 
                    ? `ì¸ê³µì§€ëŠ¥ìœµí•©ëŒ€í•™ ì†Œì†ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.`
                    : `${foundDepartment} ì†Œì†ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.`;
                document.getElementById('detectedDept').innerHTML = verificationMessage;
                
                // ê´€ë¦¬ììš© - ì¶”ì¶œëœ ì´ë¦„ ì €ì¥
                const studentIdStr = foundStudentId ? foundStudentId[0] : '-';
                const deptStr = foundDepartment || 'ì¸ê³µì§€ëŠ¥ìœµí•©ëŒ€í•™';
                addExtractedName(qrName, studentIdStr, deptStr);
                
            } catch (error) {
                console.error('ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                showError('ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            }
        }
        
        function showError(message) {
            document.getElementById('loadingSection').classList.add('hidden');
            document.getElementById('resultSection').classList.remove('hidden');
            document.getElementById('resultSection').classList.add('fade-in');
            document.getElementById('errorResult').classList.remove('hidden');
            document.getElementById('errorMessage').innerHTML = message;
        }
        
        // QR ì½”ë“œ ë””ì½”ë”© í•¨ìˆ˜
        function decodeQRCode(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);
                        
                        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                        const qrCode = jsQR(imageData.data, imageData.width, imageData.height);
                        
                        if (qrCode) {
                            resolve(qrCode.data);
                        } else {
                            resolve(null);
                        }
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }
        
        // ì´ë¯¸ì§€ ì „ì²˜ë¦¬ (ëŒ€ë¹„ í–¥ìƒ, ì„ ëª…í•˜ê²Œ)
        function preprocessImage(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • (ë„ˆë¬´ í¬ë©´ ì¶•ì†Œ, ë„ˆë¬´ ì‘ìœ¼ë©´ í™•ëŒ€)
                        let width = img.width;
                        let height = img.height;
                        const maxSize = 1500;
                        const minSize = 800;
                        
                        if (width > maxSize || height > maxSize) {
                            const ratio = Math.min(maxSize / width, maxSize / height);
                            width *= ratio;
                            height *= ratio;
                        } else if (width < minSize && height < minSize) {
                            const ratio = Math.max(minSize / width, minSize / height);
                            width *= ratio;
                            height *= ratio;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // ì´ë¯¸ì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                        const imageData = ctx.getImageData(0, 0, width, height);
                        const data = imageData.data;
                        
                        // ê·¸ë ˆì´ìŠ¤ì¼€ì¼ + ëŒ€ë¹„ í–¥ìƒ
                        for (let i = 0; i < data.length; i += 4) {
                            // ê·¸ë ˆì´ìŠ¤ì¼€ì¼
                            const gray = 0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2];
                            
                            // ëŒ€ë¹„ í–¥ìƒ (contrast factor: 1.5)
                            const factor = 1.5;
                            const adjusted = factor * (gray - 128) + 128;
                            const final = Math.max(0, Math.min(255, adjusted));
                            
                            data[i] = final;     // R
                            data[i + 1] = final; // G
                            data[i + 2] = final; // B
                        }
                        
                        ctx.putImageData(imageData, 0, 0);
                        
                        // Canvasë¥¼ Blobìœ¼ë¡œ ë³€í™˜
                        canvas.toBlob((blob) => {
                            resolve(blob);
                        }, 'image/png');
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }
        
        // OCRë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
        async function extractTextFromImage(file) {
            const result = await Tesseract.recognize(file, 'kor', {
                logger: m => {
                    if (m.status === 'recognizing text') {
                        const percent = 30 + Math.round(m.progress * 60);
                        document.getElementById('loadingStatus').textContent = 
                            `í™•ì¸ì¤‘... ${percent}%`;
                    }
                }
            });
            return result.data.text;
        }
        
        // ë„ì„œê´€ QR ì´ë¯¸ì§€ì—ì„œ ì´ë¦„ ì¶”ì¶œ (ì´ë¦„ ë¼ë²¨ì´ ìˆëŠ” ê²½ìš°)
        function extractNameFromQR(text) {
            console.log('QR OCR í…ìŠ¤íŠ¸:', text);
            
            const namePatterns = [
                // ë„ì„œê´€ QR ì´ë¯¸ì§€ íŒ¨í„´ (í…Œì´ë¸” í˜•ì‹: "ì´    ë¦„ | ê¹€ì„¸ì—°" ë˜ëŠ” "ì´ ë¦„ ê¹€ì„¸ì—°")
                /ì´\s+ë¦„\s*[|ï½œ\s]\s*([ê°€-í£]{2,4})/,
                // "ì´ë¦„: í™ê¸¸ë™" íŒ¨í„´
                /ì´\s*ë¦„\s*[:ï¼š]?\s*([ê°€-í£]{2,4})/,
                // "ì„±ëª…: í™ê¸¸ë™" íŒ¨í„´
                /ì„±\s*ëª…\s*[:ï¼š]?\s*([ê°€-í£]{2,4})/,
            ];
            
            for (const pattern of namePatterns) {
                const match = text.match(pattern);
                if (match && match[1]) {
                    console.log('QR ë§¤ì¹­ëœ íŒ¨í„´:', pattern, '-> ì´ë¦„:', match[1]);
                    return match[1].trim();
                }
            }
            
            return extractKoreanNameGeneral(text);
        }
        
        // ì£¼ë¯¼ë“±ë¡ì¦ì—ì„œ ì´ë¦„ ì¶”ì¶œ
        function extractNameFromID(text) {
            console.log('ì£¼ë¯¼ë“±ë¡ì¦ OCR í…ìŠ¤íŠ¸:', text);
            
            // í…ìŠ¤íŠ¸ ì •ê·œí™” (ì¤„ë°”ê¿ˆ, ê³µë°± ì •ë¦¬)
            const normalizedText = text.replace(/\r\n/g, '\n').replace(/\s+/g, ' ');
            
            const namePatterns = [
                // ì£¼ë¯¼ë“±ë¡ì¦ íŒ¨í„´: "ê¹€ì„¸ì—°(é‡‘ä¸–ç‡•)" - í•œì ê´„í˜¸ ì•ì˜ í•œê¸€ ì´ë¦„
                /([ê°€-í£]{2,4})\s*[\(ï¼ˆ\[ã€][ä¸€-é¾¥\u4E00-\u9FFF\u3400-\u4DBF]+[\)ï¼‰\]ã€‘]/,
                // ì£¼ë¯¼ë“±ë¡ì¦ íŒ¨í„´: "ê¹€ì„¸ì—° (é‡‘ä¸–ç‡•)" - ê³µë°± í¬í•¨
                /([ê°€-í£]{2,4})\s+[\(ï¼ˆ][^)ï¼‰]+[\)ï¼‰]/,
                // "ë“±ë¡ì¦" ë‹¤ìŒì— ë‚˜ì˜¤ëŠ” í•œê¸€ ì´ë¦„
                /ë“±ë¡ì¦[^\nê°€-í£]*([ê°€-í£]{2,4})/,
                // ì£¼ë¯¼ë²ˆí˜¸ ì•ì— ë‚˜ì˜¤ëŠ” ì´ë¦„ (6ìë¦¬-7ìë¦¬ íŒ¨í„´ ì•)
                /([ê°€-í£]{2,4})[^\d]*\d{6}\s*[-âˆ’]/,
                // ì¤„ ì‹œì‘ì—ì„œ í•œê¸€ ì´ë¦„ + ê´„í˜¸
                /^([ê°€-í£]{2,4})\s*[\(ï¼ˆ]/m,
            ];
            
            for (const pattern of namePatterns) {
                const match = text.match(pattern);
                if (match && match[1]) {
                    const name = match[1].trim();
                    // ì œì™¸ ë‹¨ì–´ í™•ì¸
                    const excludeWords = ['ì£¼ë¯¼ë“±ë¡', 'ë“±ë¡ì¦', 'ëŒ€í•œë¯¼êµ­', 'ê´‘ì—­ì‹œ', 'ì²­ì¥'];
                    if (!excludeWords.some(ex => name.includes(ex))) {
                        console.log('ì£¼ë¯¼ë“±ë¡ì¦ ë§¤ì¹­ëœ íŒ¨í„´:', pattern, '-> ì´ë¦„:', name);
                        return name;
                    }
                }
            }
            
            // ì¼ë°˜ íŒ¨í„´ìœ¼ë¡œ ì‹œë„ (ì œì™¸ ë‹¨ì–´ ë” ë§ì´)
            return extractKoreanNameFromID(text);
        }
        
        // ì£¼ë¯¼ë“±ë¡ì¦ ì „ìš© ì¼ë°˜ ì´ë¦„ ì¶”ì¶œ
        function extractKoreanNameFromID(text) {
            const generalNameMatch = text.match(/[ê°€-í£]{2,4}/g);
            if (generalNameMatch) {
                const excludeWords = [
                    'ì£¼ë¯¼ë“±ë¡ì¦', 'ì£¼ë¯¼ë“±ë¡', 'ë“±ë¡ì¦', 'ëŒ€í•œë¯¼êµ­',
                    'ê´‘ì—­ì‹œ', 'ìœ ì„±êµ¬', 'ì²­ì¥', 'ë²ˆê¸¸', 'ì•„íŒŒíŠ¸',
                    'íŠ¸ë¦¬í”Œ', 'ì‹œí‹°', 'í¬ë ˆ', 'ëŒ€ì „', 'ì„œìš¸', 'ë¶€ì‚°', 'ì¸ì²œ',
                    'ì§€ì¡±ë¡œ', 'ì§€ì¡±ë™',
                    'ë Œí˜¸', 'ë¶€ì†Œ', 'ë¯¼ë“±', 'ë¡ì¦' // OCR ì˜¤ì¸ì‹ ë‹¨ì–´ë“¤
                ];
                for (const word of generalNameMatch) {
                    const isExcluded = excludeWords.some(ex => 
                        word.includes(ex) || ex.includes(word) || word === ex
                    );
                    // 2~4ê¸€ì í•œê¸€ ì´ë¦„ì´ê³ , ì œì™¸ ë‹¨ì–´ê°€ ì•„ë‹ˆë©´
                    if (!isExcluded && word.length >= 2 && word.length <= 4) {
                        console.log('ì£¼ë¯¼ë“±ë¡ì¦ ì¼ë°˜ ë§¤ì¹­ìœ¼ë¡œ ì°¾ì€ ì´ë¦„:', word);
                        return word;
                    }
                }
            }
            return null;
        }
        
        // ì¼ë°˜ì ì¸ í•œê¸€ ì´ë¦„ ì¶”ì¶œ
        function extractKoreanNameGeneral(text) {
            // ì¼ë°˜ì ì¸ í•œê¸€ ì´ë¦„ ì°¾ê¸° (2~4ê¸€ì)
            const generalNameMatch = text.match(/[ê°€-í£]{2,4}/g);
            if (generalNameMatch) {
                const excludeWords = [
                    'ì£¼ë¯¼ë“±ë¡ì¦', 'ì£¼ë¯¼ë“±ë¡', 'ë“±ë¡ì¦', 'ëŒ€í•œë¯¼êµ­', 
                    'ê´‘ìš´ëŒ€í•™êµ', 'ê´‘ìš´ëŒ€', 'ëŒ€í•™êµ',
                    'ì»´í“¨í„°', 'ì†Œí”„íŠ¸ì›¨ì–´', 'ì •ë³´ìœµí•©', 'ì¸ê³µì§€ëŠ¥', 'ìœµí•©ëŒ€í•™',
                    'ë„ì„œê´€', 'í•™ìƒì¦', 'ëª¨ë°”ì¼', 'ì´ìš©ì¦',
                    'í•™ë¶€ìƒ', 'ëŒ€í•™ì›', 'í•™ë²ˆ', 'êµë²ˆ', 'ì†Œì†', 'ì‹ ë¶„',
                    'ê´‘ì—­ì‹œ', 'ìœ ì„±êµ¬', 'ì²­ì¥', 'ë²ˆê¸¸', 'ì•„íŒŒíŠ¸',
                    'íŠ¸ë¦¬í”Œ', 'ì‹œí‹°', 'í¬ë ˆ', 'ëŒ€ì „', 'ì„œìš¸', 'ë¶€ì‚°',
                    'ë Œí˜¸' // OCR ì˜¤ì¸ì‹ ë‹¨ì–´
                ];
                for (const word of generalNameMatch) {
                    const isExcluded = excludeWords.some(ex => 
                        word.includes(ex) || ex.includes(word) || word === ex
                    );
                    if (!isExcluded && word.length >= 2 && word.length <= 4) {
                        console.log('ì¼ë°˜ ë§¤ì¹­ìœ¼ë¡œ ì°¾ì€ ì´ë¦„:', word);
                        return word;
                    }
                }
            }
            return null;
        }
        
        // ì´ë¦„ ë¹„êµ (ì •í™• ì¼ì¹˜ + ìœ ì‚¬ë„ ë¹„êµ)
        function compareNames(name1, name2) {
            if (!name1 || !name2) return false;
            
            const n1 = name1.replace(/\s/g, '');
            const n2 = name2.replace(/\s/g, '');
            
            // ì •í™•íˆ ì¼ì¹˜
            if (n1 === n2) return true;
            
            // í•œ ê¸€ìë¼ë„ ì¼ì¹˜í•˜ë©´ (OCR ì˜¤ë¥˜ í—ˆìš©)
            // ì´ë¦„ì˜ ì²« ê¸€ì(ì„±)ê°€ ê°™ê³  ê¸¸ì´ê°€ ë¹„ìŠ·í•˜ë©´ í†µê³¼
            if (n1.length >= 2 && n2.length >= 2) {
                // ì²« ê¸€ì(ì„±) ë¹„êµ
                if (n1[0] === n2[0]) {
                    console.log('ì„±ì´ ì¼ì¹˜í•¨:', n1[0]);
                    return true;
                }
                
                // ê²¹ì¹˜ëŠ” ê¸€ì ìˆ˜ í™•ì¸
                let matchCount = 0;
                for (const char of n1) {
                    if (n2.includes(char)) matchCount++;
                }
                // 50% ì´ìƒ ì¼ì¹˜í•˜ë©´ í†µê³¼
                if (matchCount >= Math.ceil(n1.length / 2)) {
                    console.log('ìœ ì‚¬ë„ ì¼ì¹˜:', matchCount, '/', n1.length);
                    return true;
                }
            }
            
            return false;
        }
        
        function resetForm() {
            qrFile = null;
            idFile = null;
            document.getElementById('qrFileInput').value = '';
            document.getElementById('idFileInput').value = '';
            document.getElementById('qrPreviewZone').classList.add('hidden');
            document.getElementById('idPreviewZone').classList.add('hidden');
            document.getElementById('qrUploadBtn').classList.remove('hidden');
            document.getElementById('idUploadBtn').classList.remove('hidden');
            document.getElementById('verifyBtn').disabled = true;
            document.getElementById('resultSection').classList.add('hidden');
            document.getElementById('successResult').classList.add('hidden');
            document.getElementById('errorResult').classList.add('hidden');
            document.getElementById('uploadSection').classList.remove('hidden');
        }
        
        function copyCode() {
            const code = 'aiconv26';
            navigator.clipboard.writeText(code).then(() => {
                document.getElementById('copyIcon').classList.add('hidden');
                document.getElementById('checkIcon').classList.remove('hidden');
                document.getElementById('copyMsg').classList.remove('hidden');
                
                setTimeout(() => {
                    document.getElementById('copyIcon').classList.remove('hidden');
                    document.getElementById('checkIcon').classList.add('hidden');
                    document.getElementById('copyMsg').classList.add('hidden');
                }, 2000);
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = code;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                document.getElementById('copyIcon').classList.add('hidden');
                document.getElementById('checkIcon').classList.remove('hidden');
                document.getElementById('copyMsg').classList.remove('hidden');
                
                setTimeout(() => {
                    document.getElementById('copyIcon').classList.remove('hidden');
                    document.getElementById('checkIcon').classList.add('hidden');
                    document.getElementById('copyMsg').classList.add('hidden');
                }, 2000);
            });
        }
    </script>
</body>
</html>
